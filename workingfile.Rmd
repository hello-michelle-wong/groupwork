---
title: "biostats"
author: "Michelle Wong"
date: "2024-11-26"
output: html_document
---

```{r}
library(readxl)
data <- read_excel("cardiac_arrests.xlsx")
head(data)
```

### Cleaning 
```{r}
library(dplyr)

# Replace the 9999 values with NA (missing data) for relevant variables
data_clean <- data %>%
  mutate(
    sex = factor(sex),
    race = factor(race),
    amc = recode(amc, `9999` = NA),
    op_level = recode(op_level, `99` = NA, `9999` = NA),
    cpr_type = recode(cpr_type, `9999` = NA),
    hist1 = recode(hist1, `9999` = NA),
    hist2 = recode(hist2, `9999` = NA),
    hist3 = recode(hist3, `9999` = NA),
    hist4 = recode(hist4, `9999` = NA),
    hist5 = recode(hist5, `9999` = NA),
    etco2 = recode(etco2, `9999` = NA),
    rosc = recode(rosc, `9999` = NA),
    survival = recode(survival, `9999` = NA),
    time_approx = recode(time_approx, `9999` = NA),
    time_to_determination = recode(time_to_determination, `9999` = NA)
  )

# Remove rows with missing target variable (survival)
data_clean <- data_clean %>%
  filter(!is.na(survival))

# Check for missing data in other variables
summary(data_clean)

```

### Fit linear regression model 
```{r}
# Fit the logistic regression model
logit_model <- glm(survival ~ age + sex + race + amc + op_level + cpr_type + 
                   hist1 + hist2 + hist3 + hist4 + hist5 + etco2 + rosc + 
                   time_approx + time_to_determination, 
                   data = data_clean, 
                   family = binomial(link = "logit"))

# View the summary of the model
summary(logit_model)

```

### Coefficients & Odds Ratios 
```{r}
exp(coef(logit_model))
```

### Model evaluation 
```{r}
library(pROC)

# Predicted probabilities
pred_probs <- predict(logit_model, type = "response")

# AUC
roc_curve <- roc(data_clean$survival, pred_probs)
auc(roc_curve)
```

## Introduction

Scientific Question:
Clinical relevance:

## Methods

Design of Study:
Data Set Details:
Cohort:
Chosen Analysis Methodology:
Rationale:

## Results

Tables
Figures
Statistics

Exploratory/Descriptive Analysis:
Main Statistical Analysis:

## Conclusions

Main Findings:
Answer Scientific Question:
Limitations:

##References

Citations
References